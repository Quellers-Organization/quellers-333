apply plugin: 'elasticsearch.build'

base {
  archivesName = 'elasticsearch-jose-wrapper'
}

dependencies {
  api "com.nimbusds:nimbus-jose-jwt:9.37.3"
  api project(':server')
}

tasks.named("thirdPartyAudit").configure {
  ignoreMissingClasses(
    // Optional dependency of nimbus-jose-jwt for handling Ed25519 signatures and ECDH with X25519 (RFC 8037)
    'com.google.crypto.tink.subtle.Ed25519Sign',
    'com.google.crypto.tink.subtle.Ed25519Sign$KeyPair',
    'com.google.crypto.tink.subtle.Ed25519Verify',
    'com.google.crypto.tink.subtle.X25519',
    'com.google.crypto.tink.subtle.XChaCha20Poly1305',
//    'com.nimbusds.common.contenttype.ContentType',
//    'com.nimbusds.common.contenttype.ContentType$Parameter',
    'org.bouncycastle.asn1.pkcs.PrivateKeyInfo',
    'org.bouncycastle.asn1.x509.AlgorithmIdentifier',
    'org.bouncycastle.asn1.x509.SubjectPublicKeyInfo',
    'org.bouncycastle.cert.X509CertificateHolder',
    'org.bouncycastle.cert.jcajce.JcaX509CertificateHolder',
    'org.bouncycastle.crypto.InvalidCipherTextException',
    'org.bouncycastle.crypto.engines.AESEngine',
    'org.bouncycastle.crypto.modes.GCMBlockCipher',
    'org.bouncycastle.jcajce.provider.BouncyCastleFipsProvider',
    'org.bouncycastle.jce.provider.BouncyCastleProvider',
    'org.bouncycastle.openssl.PEMKeyPair',
    'org.bouncycastle.openssl.PEMParser',
    'org.bouncycastle.openssl.jcajce.JcaPEMKeyConverter',
  )
}
