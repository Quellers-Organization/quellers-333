---
"Test legacy_* codec settings":
  - requires:
      cluster_features: "gte_v8.16.0"
      reason: 'legacy options added from 8.16.0'

  - do:
      indices.create:
        index: index1
        body:
          settings:
            index:
              codec: legacy_best_compression

  - do:
      indices.get_settings:
        index: index1
        flat_settings: false
  - match:
      index1.settings.index.codec: "legacy_best_compression"

  - do:
      indices.create:
        index: index2
        body:
          settings:
            index:
              codec: legacy_default

  - do:
      indices.get_settings:
        index: index2
        flat_settings: false
  - match:
      index2.settings.index.codec: "legacy_default"
