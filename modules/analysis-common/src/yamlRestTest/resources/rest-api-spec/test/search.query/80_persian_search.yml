# integration tests for persian analyzer changes from Lucene 9 to Lucene 10
setup:
  - do:
      indices.create:
        index:  test
        body:
          mappings:
            properties:
              text:
                type: text
                analyzer: persian

---
"persian search":
  - do:
      bulk:
        refresh: true
        body:
          - '{"index": {"_index": "test", "_id": "1"}}'
          - '{"text"    : "كتابها"}'
          - '{"index": {"_index": "test", "_id": "2"}}'
          - '{"text"    : "كتاب"}'

  - do:
      search:
        rest_total_hits_as_int: true
        index: test
        body:
          query:
            match:
              text:
                query: كتابها
  - match: { hits.total: 2 }

  - do:
      search:
        rest_total_hits_as_int: true
        index: test
        body:
          query:
            match:
              text:
                query: كتاب
  - match: { hits.total: 2 }
